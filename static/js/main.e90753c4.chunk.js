(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{132:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},133:function(e,t,n){},135:function(e,t,n){"use strict";n.r(t);n(64),n(35),n(66),n(67);var a=n(1),o=n.n(a),r=n(54),c=n.n(r),u=n(143),i=(n(72),n(10)),l=n(11),s=n(15),m=n(12),h=n(16),d=n(139),p=n(62),f=n(141),b=n(142),g=n(9),E=n.n(g),v={apiHost:"https://buffalo-journal.herokuapp.com/"};E.a.defaults.headers.common.Accept="application/json";var j={isAuthenticated:!1,authenticate:function(e,t){E.a.defaults.headers.common.Authorization="Bearer "+e,window.localStorage.setItem("token",e),E.a.get("".concat(v.apiHost,"/auth/google")).then(function(e){j.isAuthenticated=!0,j.user=e.data,t&&t()})},autoLogin:function(e){var t=window.localStorage.getItem("token");t&&j.authenticate(t,e)},signout:function(e){console.log("bye now!"),j.isAuthenticated=!1,j.user=null,window.localStorage.removeItem("token"),e&&e()}},O=j,k=function(e){var t=e.component,n=Object(p.a)(e,["component"]);return o.a.createElement(f.a,Object.assign({},n,{render:function(e){return!0===O.isAuthenticated?o.a.createElement(t,e):o.a.createElement(b.a,{to:{pathname:"/",state:{from:e.location}}})}}))},y=n(140),S=n(136),w=n(137),A=n(138),I=n(55),C=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(s.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={redirectToPreviousRoute:!1},n.responseGoogle=function(e){O.authenticate(e.tokenId,function(){n.setState({redirectToPreviousRoute:!0})})},n.failGoogle=function(e){console.log("login failed",e),E.a.defaults.headers.common.Authorization=null},n.componentWillMount=function(){O.autoLogin(function(){n.setState({redirectToPreviousRoute:!0})})},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.redirectToPreviousRoute?o.a.createElement(b.a,{to:"/"}):o.a.createElement(I.GoogleLogin,{clientId:"300709606324-sec60nd2b4hba9b1gkqdcpdlhv2p89kk.apps.googleusercontent.com",buttonText:"Login",onSuccess:this.responseGoogle,onFailure:this.failGoogle})}}]),t}(a.Component),M=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(m.a)(t).call(this,e))).logout=function(){O.signout(function(){n.setState({redirect:!0})})},n.renderRedirect=function(){if(n.state.redirect)return o.a.createElement(b.a,{to:"/"})},n.state={redirect:!1},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,this.renderRedirect(),o.a.createElement(y.a,{onClick:this.logout},"Logout"))}}]),t}(a.Component);var N=function(){return o.a.createElement(S.a,null,o.a.createElement(w.a,null,O.isAuthenticated?o.a.createElement(A.a,{to:"/journal/".concat(O.user.id)},"Journal"):null),o.a.createElement(w.a,null,O.isAuthenticated?o.a.createElement(A.a,{to:"/settings/".concat(O.user.id)},"Settings"):null),o.a.createElement(w.a,null,O.isAuthenticated?o.a.createElement(M,null):null),o.a.createElement(w.a,null,o.a.createElement(C,null)))},L=n(33),R=n.n(L),G=n(60),H=n.n(G);function P(e){return o.a.createElement(S.a,null,o.a.createElement(w.a,{md:2,mdOffset:2},o.a.createElement(R.a,{format:"YYYY/MM/DD"},e.data.date)),o.a.createElement(w.a,{md:8,mdOffset:2},e.data.entry))}var T=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(m.a)(t).call(this,e))).loadEntries=function(e){E.a.get("".concat(v.apiHost,"/users/").concat(n.props.match.params.userId,"/entries/?page=").concat(e,"&per_page=").concat(20)).then(function(e){var t=n.state.entries,a=e.data;a.map(function(e){t.push(e)});var o=!0;a.length<20&&(o=!1),n.setState({entries:t,hasMore:o})})},n.state={entries:[],hasMore:!0},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=[];return this.state.entries.map(function(t){e.push(o.a.createElement(P,{key:t.id,data:t}))}),o.a.createElement(H.a,{pageStart:0,loadMore:this.loadEntries.bind(this),hasMore:this.state.hasMore,loader:o.a.createElement("div",{className:"loader",key:0},"Loading ...")},e)}}]),t}(a.Component),x=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){n.setState({settings:{phoneNumber:e.target.value}})},n.handleSubmit=function(e){E.a.put("".concat(v.apiHost,"/users/").concat(n.props.match.params.userId,"/"),{phone_number:n.state.settings.phoneNumber}).then(function(e){alert("successfully updated your phone number")}),e.preventDefault()},n.state={settings:{phoneNumber:""}},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;E.a.get("".concat(v.apiHost,"/users/").concat(this.props.match.params.userId,"/")).then(function(t){var n=t.data.phone_number;e.setState({settings:{phoneNumber:n||""}})})}},{key:"render",value:function(){return o.a.createElement(S.a,null,o.a.createElement(w.a,null,o.a.createElement("form",null,o.a.createElement("label",null,"Phone Number"),o.a.createElement("input",{type:"text",value:this.state.settings.phoneNumber,onChange:this.handleChange,name:"phone_number"}),o.a.createElement("input",{type:"submit",value:"Submit",onClick:this.handleSubmit}))))}}]),t}(a.Component),D=(n(132),n(133),function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(d.a,null,o.a.createElement(N,null),o.a.createElement(k,{path:"/journal/:userId",component:T}),o.a.createElement(k,{path:"/settings/:userId",component:x})))}}]),t}(a.Component));c.a.render(o.a.createElement(u.a,null,o.a.createElement(D,null)),document.getElementById("root"))},63:function(e,t,n){e.exports=n(135)},72:function(e,t,n){}},[[63,2,1]]]);
//# sourceMappingURL=main.e90753c4.chunk.js.map